from elasticsearch import Elasticsearch
# Create an Elasticsearch instance
# es = Elasticsearch('https://localhost:9200', basic_auth=('elastic', 'elastic'))

es = Elasticsearch([{'host': 'localhost', 'port': 9200, 'scheme': 'https'}],
                       basic_auth=('elastic', 'elastic'),
                       verify_certs=False,
                       ca_certs=None,
                       ssl_show_warn=False,
                       )

# Check if the connection was successful
if es.ping():
    print("Connected to Elasticsearch")
else:
    print("Connection failed")
    exit(0)

# Define an index name and document
index_name = "my_index"
document = {
    "title": "Example Document",
    "asd": "hahaha."
}

# Create an index (if it doesn't exist)
if not es.indices.exists(index=index_name):
    es.indices.create(index=index_name)
    print(f"Index '{index_name}' created")

# Index a document
response = es.index(index=index_name, body=document)
print(f"Document indexed with ID: {response['_id']}")
